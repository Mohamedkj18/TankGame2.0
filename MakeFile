# Compiler and flags
CXX = g++
CXXFLAGS = -std=c++20 -Wall -Wextra -pedantic -Iinclude

# Source file discovery
SRC = $(wildcard src/Common/*.cpp src/Core/*.cpp src/utils/*.cpp src/Algorithms/*.cpp) main.cpp

# Object file mapping
OBJ = $(SRC:%.cpp=obj/%.o)

# Final executable name
TARGET = tanks_game

# Default target
all: $(TARGET)

# Link object files into executable
$(TARGET): $(OBJ)
	$(CXX) $(CXXFLAGS) -o $@ $^

# Compile .cpp to .o with automatic folder creation (POSIX-compatible)
obj/%.o: %.cpp
	@mkdir -p $(dir $@)
	$(CXX) $(CXXFLAGS) -c $< -o $@

# Clean target
clean:
	rm -rf obj $(TARGET)
